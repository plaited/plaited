# Dockerfile for ACP integration tests
# Uses same bun version as CI for consistency

FROM oven/bun:1.2.9

# Install git (required by prepare script in package.json)
RUN apt-get update && apt-get install -y git && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Copy source (includes .git for prepare script)
COPY . .

# Install dependencies
RUN bun install --frozen-lockfile

# Run ACP integration tests (.docker.ts naming avoids bun test pattern matching)
# Use ./ prefix to treat as path instead of filter
CMD ["bun", "test", "./src/acp/tests/acp-integration.docker.ts"]
